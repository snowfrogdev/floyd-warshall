<div class="container">
  <div class="left-panel">
    <div class="collections">
      <div [@collectionAnimation]="(distForDisplay | async)?.length" class="dist-matrix">
        <div [@collectionAnimation]="row.length" *ngFor="let row of distForDisplay | async" style="display: flex">
          <div
            *ngFor="let element of row"
            class="dist-element"
            [ngStyle]="{
              'background-color': getDistElementBackgroundColor(element)
            }"
          ></div>
        </div>
      </div>
      <div [@collectionAnimation]="(nextForDisplay | async)?.length" class="next-matrix">
        <div [@collectionAnimation]="row.length" *ngFor="let row of next | async" style="display: flex">
          <div
            *ngFor="let element of row"
            class="next-element"
            [ngStyle]="{
              'background-color': getNextElementBackgroundColor(element)
            }"
          ></div>
        </div>
      </div>
    </div>

    <div
      class="tile-map"
      [style]="{
        'grid-template-columns': 'repeat(' + numberOfCols + ', 1.25rem)',
        'grid-template-rows': 'repeat(' + numberOfRows + ', 1.25rem)'
      }"
    >
      <div *ngFor="let tile of tiles; index as i" class="tile" [style.background-color]="tile.color">
        <div *ngIf="u === i" style="background-color: blue; opacity: 0.5"></div>
        <div *ngIf="v === i" style="background-color: red; opacity: 0.5"></div>
      </div>
    </div>

    <div class="controls" cdkDrag>
      <div class="controls-handle" cdkDragHandle><mat-icon>drag_indicator</mat-icon></div>
      <button mat-icon-button disableRipple="true" (click)="reset()"><mat-icon>replay</mat-icon></button>
      <button mat-icon-button (click)="stepBackward()"><mat-icon>skip_previous</mat-icon></button>
      <button mat-icon-button (click)="playOrPause()">
        <mat-icon *ngIf="!isPaused">pause</mat-icon>
        <mat-icon *ngIf="isPaused">play_arrow</mat-icon>
      </button>
      <button mat-icon-button (click)="stepForward()"><mat-icon>skip_next</mat-icon></button>
      <button mat-icon-button (click)="showSpeedControl = !showSpeedControl">
        <mat-icon>speed</mat-icon>
      </button>
      <div *ngIf="showSpeedControl" class="speed-slider">
        <mat-slider min="0" max="100" step="1" showTickMarks discrete [displayWith]="slidderLabel">
          <input matSliderThumb [(ngModel)]="speed" />
        </mat-slider>
      </div>
    </div>
  </div>

  <div class="right-panel">
    <pre><code class="code"><span>function floydWarshall(<span #adjacencyMatrixCodeElement [matTooltip]="adjacencyMatrix | json">adjacencyMatrix</span>):</span>
  <span [appCodeLine]="2" [lineToHighlight]="currentLine" (debuggerPoint)="handleDebuggerPoint($event)"><span [matTooltip]="dist | async | json">dist</span> = copy of <span [matTooltip]="adjacencyMatrix | json">adjacencyMatrix</span></span>
  <span [appCodeLine]="3" [lineToHighlight]="currentLine" (debuggerPoint)="handleDebuggerPoint($event)"><span [matTooltip]="next | async| json">next</span> = new matrix of size <span [matTooltip]="V | json">|V|</span> x <span [matTooltip]="V | json">|V|</span></span>
  <span [appCodeLine]="4" [lineToHighlight]="currentLine" (debuggerPoint)="handleDebuggerPoint($event)">for <span [matTooltip]="u | json">u</span> from 0 to <span [matTooltip]="V | json">|V|</span> - 1:</span>
    <span [appCodeLine]="5" [lineToHighlight]="currentLine" (debuggerPoint)="handleDebuggerPoint($event)">for <span [matTooltip]="v | json">v</span> from 0 to <span [matTooltip]="V | json">|V|</span> - 1:</span>
      <span [appCodeLine]="6" [lineToHighlight]="currentLine" (debuggerPoint)="handleDebuggerPoint($event)">if <span [matTooltip]="u | json">u</span> == <span [matTooltip]="v | json">v</span>:</span>
        <span [appCodeLine]="7" [lineToHighlight]="currentLine" (debuggerPoint)="handleDebuggerPoint($event)"><span [matTooltip]="dist | async | json">dist</span>[<span [matTooltip]="v | json">v</span>][<span [matTooltip]="v | json">v</span>] = 0</span>
        <span [appCodeLine]="8" [lineToHighlight]="currentLine" (debuggerPoint)="handleDebuggerPoint($event)"><span [matTooltip]="next | async | json">next</span>[<span [matTooltip]="v | json">v</span>][<span [matTooltip]="v | json">v</span>] = <span [matTooltip]="v | json">v</span></span>
      <span [appCodeLine]="9" [lineToHighlight]="currentLine" (debuggerPoint)="handleDebuggerPoint($event)">else if adjacenyMatrix[<span [matTooltip]="u | json">u</span>][<span [matTooltip]="v | json">v</span>] != 0:</span>
        <span [appCodeLine]="10" [lineToHighlight]="currentLine" (debuggerPoint)="handleDebuggerPoint($event)"><span [matTooltip]="next | async | json">next</span>[<span [matTooltip]="u | json">u</span>][<span [matTooltip]="v | json">v</span>] = <span [matTooltip]="v | json">v</span></span>
      else:
        <span [appCodeLine]="12" [lineToHighlight]="currentLine" (debuggerPoint)="handleDebuggerPoint($event)"><span [matTooltip]="dist | async | json">dist</span>[<span [matTooltip]="u | json">u</span>][<span [matTooltip]="v | json">v</span>] = infinity</span>
        <span [appCodeLine]="13" [lineToHighlight]="currentLine" (debuggerPoint)="handleDebuggerPoint($event)"><span [matTooltip]="next | async | json">next</span>[<span [matTooltip]="u | json">u</span>][<span [matTooltip]="v | json">v</span>] = null</span>

  <span [appCodeLine]="15" [lineToHighlight]="currentLine" (debuggerPoint)="handleDebuggerPoint($event)">for <span [matTooltip]="k | json">k</span> from 0 to <span [matTooltip]="V | json">|V|</span> - 1:</span>
    <span [appCodeLine]="16" [lineToHighlight]="currentLine" (debuggerPoint)="handleDebuggerPoint($event)">for <span [matTooltip]="i | json">i</span> from 0 to <span [matTooltip]="V | json">|V|</span> - 1:</span>
      <span [appCodeLine]="17" [lineToHighlight]="currentLine" (debuggerPoint)="handleDebuggerPoint($event)">for <span [matTooltip]="j | json">j</span> from 0 to <span [matTooltip]="V | json">|V|</span> - 1:</span>
        <span [appCodeLine]="18" [lineToHighlight]="currentLine" (debuggerPoint)="handleDebuggerPoint($event)">if <span [matTooltip]="dist | async | json">dist</span>[<span [matTooltip]="i | json">i</span>][<span [matTooltip]="j | json">j</span>] > <span [matTooltip]="dist | async | json">dist</span>[<span [matTooltip]="i | json">i</span>][<span [matTooltip]="k | json">k</span>] + <span [matTooltip]="dist | async | json">dist</span>[<span [matTooltip]="k | json">k</span>][<span [matTooltip]="j | json">j</span>]:</span>
          <span [appCodeLine]="19" [lineToHighlight]="currentLine" (debuggerPoint)="handleDebuggerPoint($event)"><span [matTooltip]="dist | async | json">dist</span>[<span [matTooltip]="i | json">i</span>][<span [matTooltip]="j | json">j</span>] = <span [matTooltip]="dist | async | json">dist</span>[<span [matTooltip]="i | json">i</span>][<span [matTooltip]="k | json">k</span>] + <span [matTooltip]="dist | async | json">dist</span>[<span [matTooltip]="k | json">k</span>][<span [matTooltip]="j | json">j</span>]</span>
          <span [appCodeLine]="20" [lineToHighlight]="currentLine" (debuggerPoint)="handleDebuggerPoint($event)"><span [matTooltip]="next | async | json">next</span>[<span [matTooltip]="i | json">i</span>][<span [matTooltip]="j | json">j</span>] = <span [matTooltip]="next | async | json">next</span>[<span [matTooltip]="i | json">i</span>][<span [matTooltip]="k | json">k</span>]</span>

<span [appCodeLine]="22" [lineToHighlight]="currentLine" (debuggerPoint)="handleDebuggerPoint($event)">return <span [matTooltip]="dist | async | json">dist</span>, <span [matTooltip]="next | async | json">next</span></span>

function reconstructPath(next, u, v):
  if next[u][v] == -1:
    return []
  path = [u]
  while u != v:
    u = next[u][v]
    path.append(u)
  return path</code></pre>
  </div>
</div>
